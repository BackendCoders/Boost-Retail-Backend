using System.ComponentModel.DataAnnotations.Schema;
using System.ComponentModel.DataAnnotations;
using SIM.Data.Models.Catalog;

namespace SIM.Data.Models
{
    public class Category
    {
        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int Id { get; set; }

        [Required]
        public string Name { get; set; }

        public int? ParentId { get; set; }  // Nullable for root categories

        [ForeignKey(nameof(ParentId))]
        public Category Parent { get; set; }

        public virtual List<Category> SubCategories { get; set; } = new List<Category>();

        public ICollection<Product> Cat1Products { get; set; } = new List<Product>();
        public ICollection<Product> Cat2Products { get; set; } = new List<Product>();
        public ICollection<Product> Cat3Products { get; set; } = new List<Product>();


        public string GetFullCategory()
        {
            var str = Name;

            if (SubCategories.Count == 1)
            {
                str += "," + SubCategories[0].Name;
            }
            if (SubCategories.Count == 2)
            {
                str += "," + SubCategories[0].Name + "," + SubCategories[1];
            }

            return str;
        }
    }
}
